---
autoGroup-1: JS基础面试题
title: 闭包
date: 2020-8-22
categories: 前端
tags:
    - JavaScript
---

## 题目1

```JavaScript
    function fn2(){
        var arr = [];
        for (var i = 0; i < 5;i++) {
            arr[i] = function (){
                return i;
            }
        }
        return arr;
    }

    var list = fn2();

    for (var i = 0 , len = list.length;i<len;i++) {
        console.log(list[i]());
    }
```

问：输出的结果是什么？

### 答案

5 5 5 5 5 

### 理由

上面的代码看起来很复杂，其实就是定义了一个空数组，里面存了五个函数，然后在下面的for循环中，遍历执行这个函数，而上面的其实就是一个闭包，因为只return了最后一位，也就是5，所以会打印五个五

## 题目2

问：如何把上面的闭包函数改成正常，使得打印出`0 1 2 3 4`？

### 答案：

```JavaScript
	function fn2(){
        var arr = [];
        for (var i = 0; i < 5;i++) {
            arr[i] = (function(i) {
                return function(){
                    return i;
                }
            })(i);
        }
        return arr;
    }

    var list = fn2();

    for (var i = 0 , len = list.length;i<len;i++) {
        console.log(list[i]());
    }
```

## 题目3

```JavaScript
    function fun(N,O){
        console.log("N="+N);
        console.log("O="+O);
        return{
            fun:function(M){
                return fun(M,N);
            }
        }
    }

    var a = fun(0);
    a.fun(1);
    a.fun(2);
    a.fun(3);
    console.log("---------------------")

    var b = fun(0).fun(1).fun(2).fun(3);
    console.log("---------------------")

    var c = fun(0).fun(1);
    console.log("---------------------")

    c.fun(2);
    console.log("---------------------")
    
    c.fun(3);
```

问：打印出来什么

### 答案

```JavaScript
    function fun(N,O){
        console.log("N="+N);
        console.log("O="+O);
        return{
            fun:function(M){
                return fun(M,N);
            }
        }
    }

    var a = fun(0);	//N = 0 , O=undefined
    a.fun(1);		//N = 1 , O = 0
    a.fun(2);		//N = 2 , O = 0
    a.fun(3);		//N = 3 , O = 0
    console.log("---------------------")

    var b = fun(0).fun(1).fun(2).fun(3);//N = 0 , O=undefined ,N = 1 , O = 0,N = 2 , O = 1，N = 3 , O = 2
    console.log("---------------------")

    var c = fun(0).fun(1);	//N = 0 , O=undefined，N = 1 O = 0 
    console.log("---------------------")

    c.fun(2);				//N = 2 O = 1
    console.log("---------------------")
    
    c.fun(3);				//N = 3 O = 1
```

第一个`var a = fun(0)`，这个就是把0传进去，返回保存了a对象，也就是刚刚传进去的0，也就是无论后面调用多少次，a.fun()的本质都是一开始传进去的0，所以打印出来的O除了第一次是没有定义为undefined之外，其余的都是0

